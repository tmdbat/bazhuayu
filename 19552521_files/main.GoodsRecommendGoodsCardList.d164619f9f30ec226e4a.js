(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{2678:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return D}));var n=a(48),c=a.n(n),o=a(2),i=a.n(o),s=a(11),l=a.n(s),r=a(1453),d=a(1173),u=a.n(d);function g(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t.trimZero,n=void 0!==a&&a,c=String(e).padStart(2,"0").slice(-2);return n&&"00"===c?"".concat(Math.floor(e/100)):"".concat(Math.floor(e/100),".").concat(c)}var m={"淘宝":"taobao","天猫":"tmall","京东":"jingdong","京东自营":"jingdongSale","知乎":"zhihu","美团酒旅":"meituanhotel","苏宁":"suning","有赞":"youzan"},b=a(1101),v=a(3),j=a.n(v),O=a(30),f=a(831),p=a(36),h=a.n(p),C=a(6);var N=function(e){var t=e.width,a=void 0===t?"10":t,n=e.height,c=void 0===n?"10":n;return Object(C.g)("svg",h()({width:a,height:c,viewBox:"0 0 10 10",fill:"none"},e),Object(C.g)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5 0C7.76142 0 10 2.23858 10 5C10 7.76142 7.76142 10 5 10C2.23858 10 0 7.76142 0 5C0 2.23858 2.23858 0 5 0ZM5 1C2.79086 1 1 2.79086 1 5C1 7.20914 2.79086 9 5 9C7.20914 9 9 7.20914 9 5C9 2.79086 7.20914 1 5 1ZM5 2C5.27614 2 5.5 2.22386 5.5 2.5V4.21902C5.5 4.54533 5.65921 4.85112 5.92654 5.03825L7.37712 6.05365C7.60334 6.21201 7.65836 6.52378 7.5 6.75C7.34164 6.97622 7.02988 7.03124 6.80365 6.87288L4.92654 5.5589C4.65921 5.37178 4.5 5.06599 4.5 4.73967V2.5C4.5 2.22386 4.72386 2 5 2Z",fill:"white"}))},k=a(1610),y="GoodsItemCardPromo",w=function(e){var t=e.countdown,a=Object(o.useState)(t),n=c()(a,2),s=n[0],l=n[1],r=Object(o.useRef)();Object(o.useEffect)((function(){return s<=0?(clearInterval(r.current),void l(0)):(r.current=setInterval((function(){l(s-1)}),1e3),function(){return clearInterval(r.current)})}),[s]);var d=Object(k.b)(s),u=d.d,g=d.h,m=d.m,b=d.s,v="".concat(u?u+"天":""," ").concat(g,":").concat(m,":").concat(b);return Object(C.g)("div",{className:y},Object(C.g)("div",{className:"".concat(y,"-left")},Object(C.g)(N,{className:"".concat(y,"-icon")}),Object(C.g)("span",null,"限时秒杀")),Object(C.g)("div",{className:"".concat(y,"-right")},s?Object(C.g)(i.a.Fragment,null,Object(C.g)("span",null,"距结束还剩 "),Object(C.g)("span",{className:"".concat(y,"-rightText")},v)):Object(C.g)("span",null,"活动已结束")))},I=function(e){var t=e.className,a=e.style,n=e.id,c=e.skuId,i=e.imgUrl,s=e.title,r=e.price,d=void 0===r?0:r,u=e.source,v=e.subtitle,j=e.tags,p=void 0===j?[]:j,h=e.promoInfo,N=void 0===h?{}:h,k=e.showBottomLine,y=void 0!==k&&k,I=e.zaData,S=void 0===I?{}:I,_=e.onClick,G=N.type,T=N.price,L=void 0===T?0:T,F=N.countdown,z=b.f.includes(G)&&F>0;Object(o.useEffect)((function(){(null==S?void 0:S.showId)&&O.a.trackCardShow(null,{id:null==S?void 0:S.showId,path:[{module_name:"".concat(n,"_").concat(c,"_").concat(m[u])}]})}),[]);return Object(C.g)("div",{className:l()("GoodsItemCard",{"GoodsItemCard-promo":z},t),style:a,onClick:function(){(null==S?void 0:S.clickId)&&O.a.trackEvent(null,{id:null==S?void 0:S.clickId,action:"OpenUrl",path:[{module_name:"".concat(n,"_").concat(c,"_").concat(m[u])}]}),"function"==typeof _&&_()}},z&&Object(C.g)(w,{countdown:F}),Object(C.g)("div",{className:"GoodsItemCard-main"},Object(C.g)("div",{className:"GoodsItemCard-left"},Object(C.g)("div",{className:"GoodsItemCard-imgLayer"}),Object(C.g)("img",{className:"GoodsItemCard-imgUrl",src:i,alt:""})),Object(C.g)("div",{className:"GoodsItemCard-right"},Object(C.g)("div",{className:"GoodsItemCard-title"},s),(null==p?void 0:p.length)?Object(C.g)("div",{className:"GoodsItemCard-tags"},p.map((function(e){var t=e.imgUrl,a=e.img_url;return Object(C.g)("img",{key:t||a,className:"GoodsItemCard-tag",src:t||a})}))):null,Object(C.g)("div",{className:"GoodsItemCard-footer"},Object(C.g)("div",{className:"GoodsItemCard-priceBox"},Object(C.g)("span",{className:"GoodsItemCard-price"},"¥".concat(g(L||d))),L?Object(C.g)("span",{className:"GoodsItemCard-originalPrice"},"¥".concat(g(d))):null),Object(C.g)("div",{className:"GoodsItemCard-source"},v||u,Object(C.g)(f.a,{size:20,center:!0})))),Object(C.g)("div",{className:"GoodsItemCard-bottomLine",style:{display:y?"block":"none"}})))};I.prototype={className:j.a.string,style:j.a.object,id:j.a.string,skuId:j.a.string,imgUrl:j.a.string.isRequired,title:j.a.string.isRequired,subtitle:j.a.string,price:j.a.number,source:j.a.string.isRequired,showBottomLine:j.a.bool,tags:j.a.array,zaData:j.a.object,promoInfo:j.a.object,onClick:j.a.func};var S=I,_=a(1713),G=a(28),T=a.n(G),L=function(){return Object(C.g)(i.a.Fragment,null)},F={SkeletonH01:function(e){var t=e.lineClass;return Object(C.g)(i.a.Fragment,null,Object(C.g)("div",{className:t}),Object(C.g)("div",{className:t}))},SkeletonP01:function(e){var t=e.lineClass,a=e.blockClass;return Object(C.g)(i.a.Fragment,null,Object(C.g)("div",{className:a}),Object(C.g)("div",null,Object(C.g)("div",{className:t}),Object(C.g)("div",{className:t})))},SkeletonT01:function(e){var t=e.lineClass;return Object(C.g)(i.a.Fragment,null,Object(C.g)("div",{className:t}),Object(C.g)("div",{className:t}),Object(C.g)("div",{className:t}),Object(C.g)("div",{className:t}))},SkeletonT02:function(e){var t=e.lineClass;return Object(C.g)(i.a.Fragment,null,Object(C.g)("div",{className:t}),Object(C.g)("div",{className:t}),Object(C.g)("div",{className:t}))},SkeletonC01:function(e){var t=e.lineClass,a=e.blockClass;return Object(C.g)(i.a.Fragment,null,Object(C.g)("div",{className:a}),Object(C.g)("div",null,Object(C.g)("div",{className:t}),Object(C.g)("div",{className:t})))},SkeletonC02:function(e){var t=e.lineClass,a=e.blockClass;return Object(C.g)(i.a.Fragment,null,Object(C.g)("div",null,Object(C.g)("div",{className:t}),Object(C.g)("div",{className:t})),Object(C.g)("div",{className:a}))},SkeletonC03:function(e){var t=e.lineClass,a=e.blockClass;return Object(C.g)(i.a.Fragment,null,Object(C.g)("div",{className:a}),Object(C.g)("div",{style:{width:"100%"}},Object(C.g)("div",{className:t}),Object(C.g)("div",{className:t})))},SkeletonC04:function(e){var t=e.lineClass,a=e.blockClass;return Object(C.g)(i.a.Fragment,null,Object(C.g)("div",{className:"".concat(a,"-1")}),Object(C.g)("div",{className:a}),Object(C.g)("div",{style:{width:"100%",display:"flex",flexDirection:"column",justifyContent:"center"}},Object(C.g)("div",{className:t}),Object(C.g)("div",{className:t})))},SkeletonI01:function(e){var t=e.blockClass;return Object(C.g)(i.a.Fragment,null,Object(C.g)("div",{className:t}))},SkeletonSpacing:L,SkeletonFill:L},z=i.a.memo((function(e){var t,a=e.variant,n=void 0===a?"H01":a,c=e.height,o=e.width,i=void 0===o?"auto":o,s=e.animation,r=void 0===s?"ease-in":s,d="skeleton__line--".concat(n.toLowerCase()),u="skeleton--".concat(n.toLowerCase()),g=l()(T()({skeleton__block:!0},"skeleton__block--".concat(n.toLowerCase()),!0)),m=l()(T()({skeleton__line:!0},d,!0)),b=l()((t={skeleton:!0},T()(t,u,!0),T()(t,"skeleton--ease-in","ease-in"===r),t)),v={width:i};c&&["Spacing","Fill"].includes(n)&&(v.height="number"==typeof c?"".concat(c,"px"):c);var j=F["Skeleton".concat(n)];return Object(C.g)("section",{className:b,style:v},Object(C.g)(j,{variant:n,lineClass:m,blockClass:g}))}));z.propTypes={variant:j.a.string,height:j.a.oneOfType([j.a.string,j.a.number]),width:j.a.oneOfType([j.a.string,j.a.number]),animation:j.a.oneOfType([j.a.bool,j.a.string])};var x=z;var M=i.a.memo((function(e){var t=e.content,a=function(e){return("string"==typeof e?e.split(","):e).map((function(e){var t=e.split("-"),a=c()(t,2),n=a[0],o=a[1];return["Spacing","Fill"].includes(n)?{type:n,height:+o}:{type:n,count:+o||1}}))}(void 0===t?"T01":t);return Object(C.g)(i.a.Fragment,null,a.map((function(e,t){var a=e.type,n=e.count,c=e.height;return n?Array.from({length:n}).map((function(e,n){return Object(C.g)(x,{variant:a,key:"".concat(t,"-").concat(n)})})):Object(C.g)(x,{variant:a,height:c,key:"".concat(t,"-").concat(c)})})))}));M.prototype={content:Object(v.oneOfType)([Object(v.arrayOf)(v.string),v.string])};var R=M,U=a(94),B={"京东":"jingdong","淘宝":"taobao","拼多多":"pinduoduo","苏宁":"suning","美团酒旅":"meituanhotel","知乎":"zhihu","有赞":"youzan"},E=function(e){var t=e.className,a=e.style,n=e.showModal,s=void 0===n||n,d=e.withModal,g=void 0===d||d,m=e.modalTitle,b=void 0===m?"该商品的所有购买渠道":m,v=e.id,j=e.url,f=void 0===j?"":j,p=e.fetcherOptions,h=void 0===p?{}:p,N=e.scenes,k=void 0===N?0:N,y=e.fetcher,w=void 0===y?r.a:y,I=e.onClose,G=e.onSelectCard;Object(U.g)();var T=Object(o.useState)(0),L=c()(T,2),F=L[0],z=L[1],x=Object(o.useState)(!1),M=c()(x,2),E=M[0],D=M[1],A=Object(o.useState)([]),P=c()(A,2),Z=P[0],q=P[1],H=Object(o.useState)(0),J=c()(H,2),V=J[0],K=J[1],Q=Object(o.useState)(!1),W=c()(Q,2),X=W[0],Y=W[1];Object(o.useEffect)((function(){O.a.trackCardShow(null,{id:10331,path:[{module_name:v}]})}),[]),Object(o.useEffect)((function(){D(!0);var e=f||"/api/v4/mcn/linkcard/".concat(v,"?scenes=").concat(k);w(e,h).then((function(e){var t=e.data,a=[],n=[];if(!u()(t)){if(a.push(Object.assign({},t,{children:null})),"[object Array]"===Object.prototype.toString.call(t.children)&&t.children.length){var c=a.concat(t.children).reduce((function(e,t){var a=t.is_similar_children,n=t.source,c=a?"similar":"same";if("知乎"===n)e[c].unshift(t);else if("京东"===n){var o=e[c].filter((function(e){return"知乎"===e.source})).length;e[c].splice(o,0,t)}else if("淘宝"===n){var i=e[c].filter((function(e){var t=e.source;return["知乎","京东"].includes(t)})).length;e[c].splice(i,0,t)}else e[c].push(t);return e}),{same:[],similar:[]});a=c.same.concat(c.similar)}"[object Array]"===Object.prototype.toString.call(t.similar_children)&&t.similar_children.length&&(n=t.similar_children.map((function(e){return Object.assign({},e,{similar:!0})})).reduce((function(e,t){var a=t.source;if("知乎"===a)e.unshift(t);else if("京东"===a){var n=e.filter((function(e){return"知乎"===e.source})).length;e.splice(n,0,t)}else if("淘宝"===a){var c=e.filter((function(e){var t=e.source;return["知乎","京东"].includes(t)})).length;e.splice(c,0,t)}else e.push(t);return e}),[]))}K(a.length),q(a.concat(n))})).catch((function(){Y(!0)})).finally((function(){setTimeout((function(){D(!1)}),500)}))}),[v,F]);var $=Object(C.g)("div",{className:"GoodsCardList-container"},E?Object(C.g)(i.a.Fragment,null,Object(C.g)(R,{content:"C03,Spacing-26,C03",height:72})):X?Object(C.g)("div",{className:"GoodsCardList-error"},Object(C.g)("div",{className:"GoodsCardList-errorDesc"},"Oops~ 出错了"),Object(C.g)("div",{className:"GoodsCardList-errorBtn",onClick:function(){z(F+1)}},"刷新重试")):Z.length?Z.map((function(e,t){var a=e.id,n=e.skuid,c=e.title,o=e.url,s=e.img_url,l=e.price,r=e.source,d=e.product_type,u=e.tags,g=e.similar,m=e.is_similar_children;return Object(C.g)(i.a.Fragment,null,g&&V===t&&Object(C.g)("div",{className:"GoodsCardList-similarText"},"相似商品"),Object(C.g)(U.b,{key:"".concat(r,"-").concat(a,"-").concat(n),block:"goodsRecommend_polymericCardPopup_goodsCard",content:{type:"GoodsRecommend",id:"".concat(a,"-").concat(n,"-").concat(B[r])},extra:{link:{url:o}}},Object(C.g)(U.e,{shouldTrackClick:!0,className:"GoodsCardList-listItem",zaType:"Card",zaText:c,zaAction:"OpenUrl",zaEventType:"Click",extra:{link:{url:o},configMap:{goodsListType:m?"similar":"same"}}},Object(C.g)(S,{id:a,skuId:n,title:c,imgUrl:s,price:l,source:r,productType:d,showBottomLine:!1,zaData:{showId:10371,clickId:10372},onClick:function(){return t=e,void(G&&G(t));var t},tags:u}))))})):null);return g?Object(C.g)(_.a,{className:l()("GoodsCardList",t),style:a,size:"large",title:b,onClose:I},s&&$):$};E.prototype={className:j.a.string,style:j.a.object,showModal:j.a.bool,withModal:j.a.bool,modalTitle:j.a.string,id:j.a.string,url:j.a.string,fetcherOptions:j.a.object,scenes:j.a.number,fetcher:j.a.func,onClose:j.a.func,onSelectCard:j.a.func};var D=E}}]);
//# sourceMappingURL=main.GoodsRecommendGoodsCardList.d164619f9f30ec226e4a.js.map