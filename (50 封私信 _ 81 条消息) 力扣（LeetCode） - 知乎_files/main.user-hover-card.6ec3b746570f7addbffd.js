(window.webpackJsonp=window.webpackJsonp||[]).push([[58],{1051:function(e,t,n){"use strict";var o=n(13),r=n(14),c=n(15),a=n(17),l=n(9),s=n(1),i=n(3),u=n.n(i),d=n(2),p=n(24),h=n(11),b=n.n(h),f=n(2595),O=n(31),j=n(844),v=n(255),m=n(67),g=n(821),y=n(30),w=n(26),M=n(1135),k=n(25);function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Object(l.a)(e);if(t){var r=Object(l.a)(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Object(a.a)(this,n)}}var R=function(e){Object(c.a)(n,e);var t=C(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,c=new Array(r),a=0;a<r;a++)c[a]=arguments[a];return(e=t.call.apply(t,[this].concat(c))).state={modalShown:!1},e.handleSendMessage=function(){var t=e.props,n=t.onModalOpen,o=t.user.allowMessage,r=t.dispatch,c=t.doNotCheckAllowMessageSetting;o||void 0===o&&c?(e.setState({modalShown:!0}),n&&n()):r(Object(w.h)(k.V.blocked,"red")),y.a.trackEvent(Object(m.a)(e),{action:"Message",element:"Button",is_intent:!0})},e.handleCloseModal=function(){var t=e.props.onModalClose;e.setState({modalShown:!1}),t&&t()},e}return Object(r.a)(n,[{key:"render",value:function(){var e=this.props,t=e.user,n=e.preset,o=e.color,r=e.icon,c=e.label,a=e.className,l=e.tooltip,i=e.tooltipPreset,u=this.state.modalShown,d="3d198a56310c02c4a83efb9f4a4c027e"===t.id;return Object(s.c)(s.a,{children:[Object(s.b)(O.c,{preset:n,color:o,className:a,icon:r,label:c,onClick:this.context.authRequired(this.handleSendMessage,d?k.X.serviceAccountMessage:k.X.message),"data-tooltip":l,"data-tooltip-preset":i}),Object(s.b)(M.a,{memberHashId:t.id,handleCloseModal:this.handleCloseModal,isModalShow:u})]})}}]),n}(d.Component);R.propTypes={onModalOpen:u.a.func,onModalClose:u.a.func},R.defaultProps={preset:"outline",color:"grey",icon:g.a,label:"发私信",doNotCheckAllowMessageSetting:!1},R.contextTypes={authRequired:u.a.func};var S=Object(p.connect)()(R),x=n(124);function B(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Object(l.a)(e);if(t){var r=Object(l.a)(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Object(a.a)(this,n)}}var N=function(e){Object(c.a)(n,e);var t=B(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,c=new Array(r),a=0;a<r;a++)c[a]=arguments[a];return(e=t.call.apply(t,[this].concat(c))).state={reportModalShown:!1},e.handleShieldUser=function(){var t=e.props,n=t.user.urlToken,o=t.updateUserBlocking,r=t.showNotification;o(n,!1).then((function(){return r("屏蔽已取消")}))},e}return Object(r.a)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.user,o=t.user,r=o.urlToken,c=o.isBlocking,a=o.isOrg,l=t.canShowMutualFollowStatus,i=t.className,u=t.buttonClassName,d=t.onModalOpen,p=t.onModalClose,h=this.context.authRequired,m=this.state.reportModalShown,g=b()("MemberButtonGroup",i);return c?Object(s.c)("div",{className:g,children:[Object(s.c)(O.c,{className:u,preset:"primary",color:"red",onClick:this.handleShieldUser,children:[Object(s.b)(f.a,{center:!0,text:!0})," 已屏蔽"]}),!a&&Object(s.c)(O.c,{className:u,onClick:h((function(){e.setState({reportModalShown:!0}),d&&d()}),k.X.report),children:["举报用户",Object(s.b)(v.a,{shown:m,onClose:function(){e.setState({reportModalShown:!1}),p&&p()},type:"member",urlToken:r,zaEnabled:!0})]})]}):Object(s.c)("div",{className:g,children:[Object(s.b)(j.a,{id:r,type:n.type,gender:n.gender,isFollowing:n.isFollowing,isFollowed:n.isFollowed,canShowMutualFollowStatus:l,className:u,preset:j.a.PRESETS.primary}),Object(s.b)(S,{user:n,className:u,onModalOpen:d,onModalClose:p})]})}}]),n}(d.Component);N.contextTypes={authRequired:u.a.func},N.propTypes={user:u.a.object.isRequired,buttonClassName:u.a.string,onModalOpen:u.a.func,onModalClose:u.a.func};t.a=Object(p.connect)(null,{updateUserBlocking:x.n,showNotification:w.h})(N)},1108:function(e,t,n){"use strict";var o=n(13),r=n(14),c=n(15),a=n(17),l=n(9),s=n(1),i=n(3),u=n.n(i),d=n(2),p=n(11),h=n.n(p),b=n(31),f=n(30),O=n(1051),j=n(25);function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Object(l.a)(e);if(t){var r=Object(l.a)(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Object(a.a)(this,n)}}var m=function(e){Object(c.a)(n,e);var t=v(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(r.a)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.user,o=t.user.isOrg,r=t.className,c=t.buttonClassName,a=t.onModalOpen,l=t.onModalClose,i=this.context,u=i.currentUser,d=i.authRequired,p=i.router,v=h()("ProfileButtonGroup",r);return u&&n.urlToken===u.urlToken?Object(s.b)("div",{className:v,children:Object(s.c)(b.c,{color:"blue",className:c,onClick:d((function(){f.a.trackEvent(e,{action:"OpenUrl",element:"Link"},{link:{url:"".concat(location.origin,"/people/edit")}}),p.push("/people/edit")}),j.X.editProfile),children:["编辑",o?"机构":"个人","资料"]})}):Object(s.b)(O.a,{user:n,canShowMutualFollowStatus:!0,className:v,buttonClassName:c,onModalOpen:a,onModalClose:l})}}]),n}(d.Component);m.contextTypes={router:u.a.object.isRequired,currentUser:u.a.object,authRequired:u.a.func},m.propTypes={user:u.a.object.isRequired,buttonClassName:u.a.string,onModalOpen:u.a.func,onModalClose:u.a.func},t.a=m},1463:function(e,t,n){"use strict";n.r(t);var o=n(32),r=n(13),c=n(14),a=n(15),l=n(17),s=n(9),i=n(1),u=n(3),d=n.n(u),p=n(2),h=n(24),b=n(37),f=n(123),O=n(30),j=n(1616),v=n(2586),m=n(114),g=n.n(m),y=n(998),w=n(387),M=n(51),k=n(929),C=n(1006),R=n(384),S=n(1108),x=n(124),B=n(25),N=n(991),T=n(104),U=n(1172),F=n(1536),P=["toggler","user","id","urlToken","mutuals","onRef"];function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Object(s.a)(e);if(t){var r=Object(s.a)(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Object(l.a)(this,n)}}var A=function(e,t){return e.map((function(e){return t[e]})).slice(0,3)},L=Object(M.isBrowser)()?g()(A,(function(e,t){return"".concat(e.join(","),"-").concat(t.length)})):A,q=[];var _=function(e){return Object(i.b)(f.Flex,Object.assign({css:{"&:not(:last-child)":{marginBottom:8}}},e))},H=function(e){Object(a.a)(n,e);var t=E(n);function n(){var e;Object(r.a)(this,n);for(var o=arguments.length,c=new Array(o),a=0;a<o;a++)c[a]=arguments[a];return(e=t.call.apply(t,[this].concat(c))).state={isLoading:!1,childModalOpened:!1},e.loadUserProfile=function(){var t=e.props,n=t.id,o=t.urlToken;return(0,t.dispatch)(Object(x.i)(o||n,!1))},e.load=function(){var t=e.props,n=t.id;(t.urlToken||n)&&(e.setState({isLoading:!0}),e.loadUserProfile().then((function(){return e.setState({isLoading:!1})})),e.loadMutuals())},e.loadMutuals=function(){var t=e.props,n=t.user,o=t.dispatch,r=t.mutuals;return!(void 0===r?[]:r).length&&e.context.currentUser&&n?o(Object(x.f)(n.urlToken,"mutuals")):Promise.resolve()},e.track=function(){var t=e.props.user;e.hoverCardElement&&t&&(O.a.setModule(e.hoverCardElement,{module:"UserItem"},{card:{content:{type:"User",member_hash_id:t.id}}}),O.a.trackCardShow(e.hoverCardElement))},e.handleOpen=function(){e.load(),e.track()},e}return Object(c.a)(n,[{key:"render",value:function(){var e,t,n=this,r=this.props,c=r.toggler,a=r.user,l=r.id,s=r.urlToken,u=r.mutuals,d=void 0===u?[]:u,p=r.onRef,h=Object(o.default)(r,P),O=a||{},m=O.isOrg,g=O.headline,M=O.avatarUrl,x=O.badge,E=O.badgeV2,A=O.answerCount,L=O.articlesCount,q=O.followerCount,H=O.employments,z=O.coverUrl,G=O.gender,I=O.isFollowed,V=O.isFollowing,X=this.state,J=X.isLoading,K=X.childModalOpened,D=d.length,Q=Object(w.e)(E||x),W=Q.bestAnswerer,Y=Q.identity,Z="//www.zhihu.com/".concat(m?"org":"people","/").concat(s||l),$=this.context.currentUser,ee=$&&a&&$.urlToken===a.urlToken,te=D>0&&!ee,ne=H&&H[0];if(null!=Y&&Y.length)t=Object(i.c)(_,{children:[Object(i.b)("a",{href:"".concat(B.F,"/account/verification/intro"),target:"_blank",rel:"noopener noreferrer",css:{marginRight:".3em"},children:Object(i.b)(w.a,{})}),Object(i.b)("div",{children:Y.slice(0,2).map((function(e){return e.description})).join("，")})]});else if(ne){var oe=ne.company,re=ne.job;t=Object(i.c)(_,{children:[(oe||re)&&Object(i.b)(f.Box,{as:"span",mr:".3em",color:"GBL05A",children:Object(i.b)(j.a,{text:!0,center:!0})}),Object(i.c)("div",{children:[oe&&oe.name,oe&&re&&Object(i.b)(f.Box,{display:"inline-block",width:"1px",height:"10px",mx:"8px",bg:"GBK09A"}),re&&re.name]})]})}else t=null;return Object(i.c)(C.b,Object.assign(Object.assign({toggler:c,onOpen:this.handleOpen,isLoading:J,globalClose:!K,stickHover:K,preventCloseOnTarget:!0},h),{},{onRef:function(e){p&&"function"==typeof p&&p(e),n.hoverCardElement=e},children:[Object(i.b)(C.a,{coverUrl:z,title:Object(i.c)("span",{css:{display:"flex"},children:[Object(i.b)(N.a,{user:a,noHoverCard:!0}),Object(i.b)(F.a,{isFollowed:I,isFollowing:V})]}),subtitle:g&&Object(i.b)(R.a,{inline:!0,html:g}),avatarUrl:M}),(t||W||te)&&Object(i.c)("div",{children:[t,Boolean(null==W||null===(e=W.topics)||void 0===e?void 0:e.length)&&Object(i.c)(_,{children:[Object(i.b)("span",{css:{marginRight:".3em"},children:Object(i.b)(w.b,{})}),Object(i.c)("div",{children:[Object(i.b)(U.a,{expandable:!1,noHoverCard:!0,topics:W.topics,user:a}),"的优秀答主"]})]}),te&&Object(i.c)(_,{color:"GBL05A",children:[Object(i.b)(f.Box,{mr:".3em",children:Object(i.b)(v.a,{text:!0,center:!0})}),Object(i.b)("div",{children:Object(i.c)(y.CJKSpace,{children:[d.map((function(e,t){return Object(i.c)(b.Link,{to:"//www.zhihu.com/".concat(m?"org":"people","/").concat(e.urlToken),target:"_blank",children:[e.name,t<D-1&&"、"]},t)})),"也关注了",B.O[G]]})})]})]}),Object(i.c)("div",{children:[Object(i.c)(k.a,{children:[Object(i.b)(k.a.Item,{tag:T.a,preset:"plain",to:"".concat(Z,"/answers"),name:"回答",value:A,target:"_blank"}),Object(i.b)(k.a.Item,{tag:T.a,preset:"plain",to:"".concat(Z,"/posts"),name:"文章",value:L,target:"_blank"}),Object(i.b)(k.a.Item,{tag:T.a,preset:"plain",to:"".concat(Z,"/followers"),name:"关注者",value:q,target:"_blank"})]}),a&&!ee&&Object(i.b)(S.a,{className:"HoverCard-buttons",user:a,onModalOpen:function(){n.hoverCardElement.style.opacity="0",n.setState({childModalOpened:!0})},onModalClose:function(){return n.setState({childModalOpened:!1})}})]})]}))}}]),n}(p.PureComponent);H.contextTypes={currentUser:d.a.object},t.default=Object(h.connect)((function(e,t){var n=t.id,o=t.urlToken,r=e.entities,c=e.people.mutualsByUser,a=r.users[o]||Object.values(r.users).find((function(e){return e.id===n}))||t.user,l=c[o||n]||{ids:q,isFetching:!1},s=l.ids,i=l.isFetching;return{user:a,mutuals:L(s,r.users),isFetching:i}}))(H)},1616:function(e,t,n){"use strict";var o=n(2),r=n.n(o),c=n(21),a=function(e){return r.a.createElement(c.a,e,r.a.createElement("path",{d:"M17 6.998h3.018c1.098 0 1.975.89 1.982 2.002v10a1.993 1.993 0 0 1-1.987 2H3.98A1.983 1.983 0 0 1 2 19l.009-10.003c0-1.11.873-1.999 1.971-1.999L7 7V5c.016-1.111.822-2 2-2h6c.98 0 1.86.889 2 2v1.998zM9 7h6V5.5s0-.5-.5-.5h-5c-.504 0-.5.5-.5.5V7z",fillRule:"evenodd"}))};a.defaultProps={name:"Company"},t.a=a}}]);
//# sourceMappingURL=main.user-hover-card.6ec3b746570f7addbffd.js.map